<HTML>
<BODY BGCOLOR="#FFFFFF">

<a href="javascript:back();">back</a>

<H1>Basic steps to build and install OBM 0.3.x</H1>

<OL>
<LI> Get the source (should be done if you have this file)
<LI> Install MySQL or PostgreSQL if not on your system.
<LI> Build and Install Apache with PHP3 module activated.
<OL>
   <LI> Build PHP3 with MySQL or PostgreSQL support (or both !)
   <LI> Build Apache with PHP3 module.
</OL>
<LI> Configure apache to process PHP3 files, and test it (with test.php3) !
<OL>
   <LI> Configure the Apache document root.
   <LI> Configure apache to process PHP3 files.
   <LI> Restart Apache and test it.
</OL>
<LI> Configure PHP (include path in "php3.ini" ...).
<LI> Create the OBM databases
<OL>
   <LI> Create the obm database
   <LI> Create the obm_session_db database
</OL>
<LI> Copy everything in the php directory somewhere in your Web document tree.
<LI> Select the database (MySQL or PostgreSQL) for phplib.
<LI> Run OBM (access the obm.php3 from your browser).
</OL>

<H1> Detailed Installation </H1>

Here is a more detailed guideline to install obm.
For mysql, postgresql, apache and php install parts, if you encounter troubles I suggest you look into their own documentations.
<P>
We suppose that (as an example, only needed for 5: and 7:)
<BR>the web Document root is /home/web
<BR>the obm root is /home/web/obm
<P>


<H2>1: Get the source</H2>
# Would be more difficult without it


<H2>2: Installing MySQL or PostgreSQL</H2>
# Follow their own documentation

<H2>3: Build and Install Apache with PHP3 module activated</H2>
# Basically the steps are:
<BR># Desarchive in the same directory

<P>gunzip apache_1.3.x.tar.gz
<BR>tar xvf apache_1.3.x.tar
<BR>gunzip php-3.0.x.tar.gz
<BR>tar xvf php-3.0.x.tar
<P>
# A first ./configure of apache seems to be needed
<P>
cd apache_1.3.x
<BR>./configure

<H3>3.1: Build PHP3 with MySQL or PostgreSQL support</H3>

cd ../php-3.0.x
<BR># For MySQL
<BR>./configure --with-mysql --with-apache=../apache_1.3.x --enable-track-vars
<BR># For PostgreSQL
<BR>./configure --with-pgsql --with-apache=../apache_1.3.x --enable-track-vars
<BR>make
<BR>make install

<H3>3.2: Build and Install Apache</H3>
$ cd ../apache_1.3.x
<BR>$ ./configure --activate-module=src/modules/php3/libphp3.a
<BR>$ make
<BR>$ /usr/local/apache/bin/apachectl stop
<BR>$ make install

<H2>4: Configure apache, and test it (with test.php3) !</H2>
<H3>4.1: Configure the Apache document root</H3>
# Edit your httpd.conf and modify the DocumentRoot and its Directory entries:
<BR>DocumentRoot "/home/web"
<BR>...
<BR>< Directory "/home/web">
<P>
# or you can keep the default configuration which could be
<BR>DocumentRoot "/usr/local/apache/htdocs"      # default from sources
<BR>DocumentRoot "/home/httpd"
 
<H3>4.2: Configure apache to process PHP3 files</H3>

# Edit your httpd.conf or srm.conf file and add:
<BR>AddType application/x-httpd-php3 .php3

<H3>4.3: Restart Apache and test it</H3>
# Restart Apache
<BR>/usr/local/apache/bin/apachectl restart
<P>
# Open the test.php3 page with netscape


<H2>5: Configure PHP (include path in "php3.ini" ...)</H2>
# Edit the php3.ini file (/usr/local/lib/php3.ini)
<BR># Add the phplib and the working directories in the include path
<BR>include_path = "what_was_here_before:/home/web/obm:."
<BR># unfill the auto_prepend_file and auto_append_file vars.
<BR>auto_prepend_file = ;
<BR>auto_append_file = ;


<H2>6: Create the OBM database</H2>

<H3>6.1: Create the obm database - MySQL</H3>
# The SQL scripts are in the scripts directory
<P>
# First, create the user web for mysql access to obm database
<BR>mysql -u root mysql    # or with the user who have the rights
<P>
# user web, password web
<BR>insert into user values("localhost","web",password("web"),"Y","Y","Y","Y","Y","Y","Y","Y","Y","Y","Y","Y","Y","Y");
<P>
# Because of the way the mysql access rights works you may have to remove the
<BR># standard access from localhost
<BR>delete from user where Host="localhost" and Select_priv="N";
<P>
# You have to restart the mysql daemon for the new acces rights to take effect
# or use mysqladmin
<P>
# create the database obm.
<BR># In any SQL editor
<BR>create database obm;
<P>
# Open the file create_obm_db.mysql.sql in an SQL editor and run it.
<BR># You may be forced to create each tables separatedly from an editor.
<BR># The simplest is to execute :
<BR>mysql -u web -pweb obm < create_obm_db.mysql.sql
<BR># For french people it would be better to execute (database in french)
<BR>mysql -u web -pweb obm < create_obm_db_fr.mysql.sql
<P>
# restart mysql for the new access rights to be effective;
<BR># Or just reload the grant tables
<BR>mysqladmin -u user -p reload

<H3>6.2: Create the obm database - PostgreSQL</H3>
# The SQL scripts are in the scripts directory
<P>
# create the database obm. Use the "postgres" user account or your postgres
admin account to create the database.
<BR># In a Unix shell editor, under the "postgres" unix user :
<BR>$ createdb obm;
<P>
# Run the file create_obm_db.pgsql.sql with psql
<BR>psql obm -f create_obm_db.pgsql.sql > createobm.err 2>&1
<BR># For french people it would be better to execute when available (database in french)
<BR>psql obm -f create_obm_db_fr.pgsql.sql > createobm.err 2>&1
<P>
Set environment variable for PostgreSQL use for postgres user in .bash_profile (for bash shell) :
<BR># PGLIB, PGDATA are set by default
<BR># add PGDATESTYLE not set by default:
<BR>export PGDATESTYLE=ISO

<H2>7: Copy everything in the php directory somewhere in your Web document tree</H2>
# you must have write permissions on the web directory
<BR># we suppose you are in the obm directory
<P>
cp -r ./php/* /home/web/obm

<H2>8: Select the database (MySQL or PostgreSQL) for phplib</H2>
# in obminclue/phplib edit the file obmlib.inc and comment one of these two
lines :
<BR>require("obminclude/phplib/db_pgsql.inc");       ## Postgres
<BR>require("obminclude/phplib/db_mysql.inc");       ## Mysql
<P>
# then declare the right db type, user and password in the DB_OBM class (same file)
<BR>var $type     = $db_type_pgsql;   # for PostgreSQL
<BR>var $type     = $db_type_mysql;   # for MySQL
<P> # user and password (web ,web for mysql)
<BR>var $User     = "obm_user";       ## Postgres 
<BR>var $Password = "obm_pass";       ## Postgres 

<P>
# For example, if you want to use PostgreSQL :
<BR>require("obminclude/phplib/db_pgsql.inc");       ## Postgres
<BR>// require("obminclude/phplib/db_mysql.inc");    ## Mysql
<BR>...
<BR>class DB_OBM extends DB_Sql {
<BR>...
<BR>var $type     = $db_type_pgsql;
<BR>var $User     = "obm_user";
<BR>var $Password = "obm_pass";


<H2>9: Run OBM (access the obm.php3 from your browser)</H2>
# First restart your apache web server

<P>/usr/local/apache/bin/apachectl restart

<P># If all goes well run netscape and launch the url
<BR>yourserver/obm/obm.php3

<P>
<H1>Comments</H1>
php3.ini is no longer installed with the default installation of php3
(version 3.0.16) thus the user must get it from somewhere else (there also
might be a compiler option, but I don't know what it is...) - also,
according to the php3 manual, php3.ini is no longer necessary - all of the
options that are available through php3.ini are available via the .conf
files (although I didn't figure out how to do it myself... they are supposed
to be in the format php3_ followed by the option that was originally in
php3.ini). (Tom Musgrove)

<br><bR><br>
<A NAME="upgrade-0.3.3">
<H1>UPGRADE OBM DATABASE 0.3.2 to 0.3.3</H1></a>
<P>
  You just have to create 3 news tables in your database OBM. To create them, just type:<br>
    mysql -u web -pweb obm < update_obm_db_.0.3.2-0.3.3.mysql.sql <i>#or with the user who have the rights </i><br>
 <b>Important :</b> For a postgres database the file is update_obm_db_.0.3.2-0.3.3.pgsql.sql
<br><br>
<a href="javascript:back();">back</a>

</BODY>
</HTML>
