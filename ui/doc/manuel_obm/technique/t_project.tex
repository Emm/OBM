\section{Calendar}

Le module \project \obm  est un agenda partagé permettant d'inserer, modifier, consulter ou supprimer des évenements pour un ou plusieurs utilisateurs simultané.

\clearpage

\subsection{Organisation de la base de données}

Le \calendar utilise trois tables :
\begin{itemize}
 \item Deal (aussi utilisé par le module \deal)
 \item ProjectTask
 \item ProjectUser
 \item ProjectStat
\end{itemize}

\subsubsection{Deal}
Cette table utilisée pour stocker les informations relatives aux affaires.
Elle sert aussi à stocker certaines infos relatives spécifiquement aux projets.
Nous ne détaillerons que les informations utilisées par le module \project.
\begin{description}
 \item[deal\_id] int(8) : C'est la clé primaire de la table.
 \item[deal\_timeupdate] timestamp(14) : Donne au format Unix la date de dernière mise à jour du tuple.
 \item[deal\_timecreate] timestamp(14) : Donne au format Unix la date de création du tuple.
 \item[deal\_userupdate] int(8) : Id de l'utilisateur qui à opéré la dernière mise à jour.
 \item[deal\_usercreate] int(8) : Id de l'utilisateur qui à créé le tuple.
 \item[deal\_label] varchar(128) : label du projet.
 \item[deal\_company\_id] int(8) : Clé étrangère pointant vers Company indiquant la société puor laquelle le projet est réalisée (sauf pour le projets internes).
 \item[deal\_tasktype\_id] int(8) : Clé étrangère pointant vers TaskType indiquant le type de tâche concerné par ce projet.
 \item[deal\_soldtime] int(8) : Durée en jours de travail vendue à la société pour laquelle ce projet est réalisé.
 \item[deal\_project\_status] int(1) : Indique si le projet est est encore au stade d'affaire, s'il est en cours ou si il s'agit d'un projet interne (pas de partie affaire).
 \item[deal\_archive] int(2) : Indique si le projet (et l'affaire qui lui est associée) est archivé.
\end{description}

\subsubsection{ProjectTask}
Cette table stocke les informations relatives au découpage d'un projet en tâches.
\begin{description}
 \item[projecttask\_id] int(8) : C'est la clé primaire de la table.
 \item[projecttask\_timeupdate] timestamp(14) : Donne au format Unix la date de dernière mise à jour du tuple.
 \item[projecttask\_timecreate] timestamp(14) : Donne au format Unix la date de création du tuple.
 \item[projecttask\_userupdate] int(8) : Id de l'utilisateur qui à opéré la dernière mise à jour.
 \item[projecttask\_usercreate] int(8) : Id de l'utilisateur qui à créé le tuple.
 \item[projecttask\_label] varchar(255) : Label de la tâche.
 \item[projecttask\_deal\_id] int(8) : Clé étrangère pointant vers Deal indiquant le projet auquel est rataché cette tâche.
 \item[projecttask\_parenttask\_id] int(8)  : Clé étrangère pointant vers ProjectTask indiquant s'il s'agit d'une sous-tâche ratachée à une autre tâche du projet
 \item[projecttask\_rank] int(8) : Valeur qui permet de gérer l'ordre d'affichage des tâches.
\end{description}

\subsubsection{ProjectUser}
Cette table stocke les informations relatives à l'affectation d'utilisateurs à des projets.
Ils sont en réalité ratachés à une tâche du projet.
\begin{description}
 \item[projectuser\_id] int(8) : C'est la clé primaire de la table.
 \item[projectuser\_user\_id] int(8) : Clé étrangère pointant vers UserObm indiquant l'utilisateur concerné.
 \item[projectuser\_deal\_id] varchar(12) :Clé étrangère pointant vers Deal indiquant le projet auquel est rataché l'utilisateur. Cette information peut sembler redondante mais est nécessaire pour pouvoir affecter un utilisateur à un projet avant que les tâches du projet ne soient définies.
 \item[projectuser\_projecttask\_id] varchar(12) :Clé étrangère pointant vers ProjectTask indiquant la tâche à laquelle est affecté cet utilisateur.
 \item[projectuser\_timeupdate] timestamp(14) : Donne au format Unix la date de dernière mise à jour du tuple.
 \item[projectuser\_timecreate] timestamp(14) : Donne au format Unix la date de création du tuple.
 \item[projectuser\_userupdate] int(8) : Id de l'utilisateur qui à opéré la dernière mise à jour.
 \item[projectuser\_usercreate] int(8) : Id de l'utilisateur qui à créé le tuple.
 \item[projectuser\_projectedtime] varchar(5) : .
 \item[projectuser\_missingtime] varchar(5) : .
 \item[projectuser\_validity] char(1) : Date de la dernière modification de l'avancement. Permet de vérifier la crédibilité des informations disponibles sur l'avancement du projet (non implémenté pour l'instant).
 \item[projectuser\_soldprice] char(1) : Tarif horaire de cet utilisateur. Permet une analyse des coûts plus détaillée pour le projet (non implémenté pour l'instant).
 \item[projectuser\_manager] char(1) : Indique si la personne est chef de projet. Influe sur les droits de modification.
\end{description} 

\subsubsection{ProjectStat}
Cette table stocke les informations relatives à l'avancement du projet à chaque fois que celles-ci sont modifiées.

\begin{description}
 \item[projectuser\_deal\_id] int(8) : C'est la clé primaire de la table. Indique le projet concerné.
 \item[projectuser\_date] timestamp(14) : C'est la clé primaire de la table. Donne au format Unix à laquelle a été effectué le log.
 \item[projectuser\_timecreate] timestamp(14) : Donne au format Unix la date de création du tuple.
 \item[projectuser\_usercreate] int(8) : Id de l'utilisateur qui à créé le tuple.
 \item[projectuser\_useddays] int(8) : Nombre de jours de travail passés sur le projet au moment du log.
 \item[projectuser\_remainingdays] int(8) : Nombre de jours de travail estimé restant pour terminer le projet au moment du log.
\end{description} 

\clearpage


\subsection{Actions, droits, et fonctions}
Dans cette section seront listées et décrites les actions du module, ainsi que les droits qui leurs sont appliqués et l'intitulé des fonctions executées. 

\subsubsection{Actions}

Voici la liste des action du module \project, ainsi qu'une description sommaire de chacune d'entre elles.\\
\begin{tabular}{|c|p{9cm}|}
 \hline
 \textbf{Intitulé} & \textbf{Description} \\
 \hline
 \hline
  <index> & Action par défaut, elle affiche le formulaire de recherche de projets. \\ 
 \hline
  <search> & Affiche le formulaire de recherche de projets et le résultat de la recherche. \\
 \hline
  <new> & Affiche le formulaire permettant de créer interne. \\
 \hline
  <init> & Affiche le formulaire permettant de créer un projet à partir d'une affaire. \\
 \hline
  <task\_fill> & Affiche le formulaire permettant l'ajout de tâches au projet. \\
 \hline
  <member\_fill> & Affiche la liste des participants au projet et leurs statuts respectifs. \\
 \hline
  <membertime\_fill> & Affiche le formulaire permettant l'affectation des participants aux différentes tâches. \\
 \hline
  <vaildate> & Valide les modifications faites à l'écran de modification des affectations et affiche l'écran de consultation. \\
 \hline
  <detailconsult> & Affiche l'écran de consultation. \\
 \hline
  <detailupdate> & Affiche le formulaire permettant de modifier les informations relatives au projet. \\
 \hline
  <d\_update> & Valide les modifications faites à l'écran de modification du projet et affiche l'écran de consultation. \\
 \hline
  <advanceupdate> & Affiche le formulaire permettant de modifier les informations relatives au projet. \\
 \hline
  <a\_update> & . \\
 \hline
  <ext\_get\_ids> & affiche une fenêtre permettant d'ajouter des participants au projet (géré par le module \user). \\
 \hline
  <task\_add> & . \\
 \hline
  <task\_del> & . \\
 \hline
  <member\_add> & . \\
 \hline
  <member\_del> & . \\
 \hline
  <member\_change> & . \\
 \hline
  <display> & . \\
 \hline
  <dispref\_display> & . \\
 \hline
  <dispref\_level> & . \\
 \hline
\end{tabular}

\clearpage

\subsubsection{Droits}

Ci-dessous le tableau présentant les droits necessaires à l'execution de chaque action ainsi que l'intitulé de ce droit. \\
\begin{tabular}{|c|c|l|}
 \hline
 \textbf{Action} & \textbf{Code du droit} & \textbf{Intitulé du droit}\\
 \hline
 \hline
  <index> & agenda\_read & Droits d'Utilisateur en lecture. \\ 
 \hline
 <decision> & agenda\_write & Droits d'Utilisateur en ecriture. \\ 
 \hline
  <view\_year> & agenda\_read & Droits d'Utilisateur en lecture. \\ 
 \hline
  <view\_month> & agenda\_read & Droits d'Utilisateur en lecture. \\
 \hline
  <view\_week> & agenda\_read & Droits d'Utilisateur en lecture. \\
 \hline
 <new> & agenda\_write & Droits d'Utilisateur en ecriture. \\
 \hline
 <insert> & agenda\_write & Droits d'Utilisateur en ecriture. \\ 
 \hline
 <insert\_conflict> & agenda\_write & Droits d'Utilisateur en ecriture. \\ 
 \hline
  <view\_day> & agenda\_read & Droits d'Utilisateur en lecture. \\ 
 \hline
  <detail\_consult> & agenda\_read & Droits d'Utilisateur en lecture. \\
 \hline
  <check\_delete> & agenda\_admin\_write & Droits d'Administrateur en ecriture. \\
 \hline
  <delete> & agenda\_admin\_write & Droits d'Administrateur en ecriture. \\
 \hline
  <detailupdate> &  agenda\_write & Droits d'Utilisateur en ecriture. \\
 \hline
  <update> & agenda\_write & Droits d'Utilisateur en ecriture. \\
 \hline
  <update\_decision> & agenda\_write & Droits d'Utilisateur en ecriture. \\
 \hline
\end{tabular}
\subsubsection{Fonctions}
 Ci-dessous le tableau présentant la ou les fonctions appelées pour chacune des actions. \\
\begin{tabular}{|c|c|}
 \hline
 \textbf{Action} & \textbf{Fonction(s)}\\
 \hline
 \hline
  <index> & run\_query\_waiting\_events() \\
          & display\_warn\_msg() \\  
          & html\_waiting\_events() \\ 
          & ou \\ 
 	  & run\_query\_waiting\_events() \\
	  & run\_query\_week\_event\_list() \\
	  & run\_query\_get\_user\_name() \\
	  & run\_query\_userobm() \\
	  & dis\_week\_planning() \\
	  & localizeDate() \\
	  & store\_users() \\
	  & store\_events() \\
	  & html\_planning\_bar() \\
 \hline
  <decision> & run\_query\_insert\_decision() \\ 
             & display\_ok\_msg \\
   	     & run\_query\_waiting\_events() \\
  	     & run\_query\_week\_event\_list() \\
	     & run\_query\_get\_user\_name() \\
	     & run\_query\_userobm() \\
	     & dis\_week\_planning() \\
	     & localizeDate() \\
	     & store\_users() \\
	     & store\_events() \\
	     & html\_planning\_bar() \\
	     & ou \\
	     & display\_warn\_msg() \\
	     & html\_dis\_conflict() \\
 \hline
  <view\_year> & run\_query\_year\_event\_list() \\
 	       & run\_query\_get\_user\_name() \\
	       & run\_query\_userobm() \\
	       & dis\_year\_planning() \\
	       & localizeDate() \\
	       & store\_users() \\
	       & store\_daily\_events() \\
	       & html\_planning\_bar() \\
 \hline
  <view\_month> & run\_query\_month\_event\_list() \\
 	        & run\_query\_get\_user\_name() \\
	        & run\_query\_userobm() \\
	        & dis\_month\_planning() \\
	        & localizeDate() \\
	        & store\_users() \\
	        & store\_daily\_events() \\
	        & html\_planning\_bar() \\
 \hline
 \end{tabular}

\begin{tabular}{|c|c|p{3cm}|}
 \hline
 \textbf{Action} & \textbf{Fonction(s)} \\
 \hline
 \hline
  <view\_week> & run\_query\_week\_event\_list() \\
	       & run\_query\_get\_user\_name() \\
	       & run\_query\_userobm() \\
	       & dis\_week\_planning() \\
	       & localizeDate() \\
	       & store\_users() \\
	       & store\_events() \\
	       & html\_planning\_bar() \\   	    
 \hline
  <view\_day> & run\_query\_day\_event\_list() \\ 
	      & run\_query\_get\_user\_name() \\
	      & run\_query\_userobm() \\
	      & dis\_day\_planning() \\
	      & localizeDate() \\
	      & store\_users() \\
	      & store\_events() \\
	      & html\_planning\_bar() \\  
 \hline
 <insert> & check\_data\_form() \\ 
          & run\_query\_week\_event\_list() \\
          & run\_query\_get\_user\_name() \\
          & run\_query\_userobm() \\
          & display\_ok\_msg() \\
          & dis\_week\_planning() \\
	  & localizeDate() \\
	  & store\_users() \\
	  & store\_events() \\
	  & html\_planning\_bar() \\
	  & ou \\	  
	  & check\_data\_form() \\ 
          & display\_warn\_msg() \\
          & html\_dis\_conflict() \\
	  & ou \\	
	  & check\_data\_form() \\ 
          & display\_err\_msg() \\
	  & run\_query\_userobm() \\
          & run\_query\_get\_eventcategories() \\
          & run\_query\_userobm() \\
          & dis\_event\_form() \\
	  & ou \\	
	  & check\_data\_form() \\ 
          & display\_warn\_msg() \\
	  & run\_query\_userobm() \\
          & run\_query\_get\_eventcategories() \\
          & run\_query\_userobm() \\
          & dis\_event\_form() \\

 \hline
\end{tabular}

\begin{tabular}{|c|c|p{3cm}|}
 \hline
 \textbf{Action} & \textbf{Fonction(s)} \\
 \hline
 \hline
 <insert\_conflict> & run\_query\_manage\_conflict()\\ 
                    & run\_query\_week\_event\_list() \\
                    & run\_query\_get\_user\_name() \\
                    & run\_query\_userobm() \\
                    & display\_ok\_msg() \\
                    & dis\_week\_planning() \\
            	    & localizeDate() \\
	            & store\_users() \\
	            & store\_events() \\
	            & html\_planning\_bar() \\
 \hline 
 <new> & run\_query\_userobm() \\
       & run\_query\_get\_eventcategories() \\
       & run\_query\_userobm() \\
       & dis\_event\_form() \\
 \hline
  <detail\_consult> & run\_query\_detail() \\
  		    & run\_query\_event\_customers() \\
		    & display\_record\_info() \\
		    & html\_calendar\_consult() \\
 \hline
  <check\_delete> & html\_dis\_delete() \\
 \hline
  <delete>  & run\_query\_delete() \\
  	    & run\_query\_waiting\_events() \\
	    & run\_query\_week\_event\_list() \\
	    & run\_query\_get\_user\_name() \\
	    & run\_query\_userobm() \\
	    & dis\_week\_planning() \\
	    & localizeDate() \\
	    & store\_users() \\
	    & store\_events() \\
	    & html\_planning\_bar() \\
 \hline
  <detailupdate> & run\_query\_userobm() \\
  		 & run\_query\_get\_eventcategories() \\
  		 & run\_query\_detail() \\
  		 & run\_query\_event\_customers\_array() \\
  		 & display\_record\_info() \\
  		 & dis\_event\_form() \\
 \hline
\end{tabular}

\begin{tabular}{|c|c|p{3cm}|}
 \hline
 \textbf{Action} & \textbf{Fonction(s)} \\
 \hline
 \hline
  <update> & check\_data\_form() \\
           & run\_query\_modify\_event() \\
           & display\_ok\_msg \\
           & run\_query\_week\_event\_list() \\
           & run\_query\_get\_user\_name() \\
           & run\_query\_userobm() \\
           & display\_ok\_msg() \\
           & dis\_week\_planning() \\
           & localizeDate() \\
	   & store\_users() \\
	   & store\_events() \\
	   & html\_planning\_bar() \\
           & ou \\
           & check\_data\_form() \\
           & run\_query\_modify\_event() \\
           & display\_warn\_msg( \\
           & html\_dis\_conflict() \\
           & ou \\
	   & check\_data\_form() \\
	   & run\_query\_modify\_event() \\
           & display\_error\_msg() \\
           & html\_dis\_conflict() \\
           & run\_query\_week\_event\_list() \\
           & run\_query\_get\_user\_name() \\
           & run\_query\_userobm() \\
           & display\_ok\_msg() \\
           & dis\_week\_planning() \\
           & localizeDate() \\
	   & store\_users() \\
	   & store\_events() \\
	   & html\_planning\_bar() \\	   
           & ou \\
	   & check\_data\_form() \\
           & display\_warn\_msg() \\
           & run\_query\_userobm() \\
           & run\_query\_get\_eventcategories() \\
           & dis\_event\_form() \\
 \hline
\end{tabular}

\begin{tabular}{|c|c|p{3cm}|}
 \hline
 \textbf{Action} & \textbf{Fonction(s)} \\
 \hline
 \hline 
  <update\_decision> & run\_query\_change\_decision() \\
                     & display\_ok\_msg \\
                     & run\_query\_week\_event\_list() \\
                     & run\_query\_get\_user\_name() \\
                     & run\_query\_userobm() \\
                     & display\_ok\_msg() \\
                     & dis\_week\_planning() \\
            	     & localizeDate() \\
	             & store\_users() \\
	             & store\_events() \\
	             & html\_planning\_bar() \\
		     & ou \\
		     & run\_query\_change\_decision() \\
		     & display\_warn\_msg() \\
		     & html\_dis\_conflict() \\
 \hline
\end{tabular}
\subsection{Fonctionalité}
 Dans cette partie seront abordées les fonctionnalités du module \calendar. Ces fonctionnalités seront étudiés d'un point de vue technique et non utilisateur. Il va donc plus etre sujet du fonctionnement que de l'utilité et de l'utilisation du module.

\subsubsection{Affichage}
 Nous passerons assez rapidement sur l'affichage des details d'un évenement qui est une fonctionnalité assez basique(recherche des éléments en base, puis affichage de ces derniers de manière structuré).
 Nous nous interresseront plus au differentes vues du planning.

 Nous alons dans un premier temps traiter les vues quotidiennes et hebdomadaire.
 Ces deux vues seront traités ensemble car leurs fonctionnements est assez similaires. Nous épiloguerons sur les vues mensuelles et annuelles qui divergent légérement ces deux vues.
 Les etapes de la production de cette affichage sont les suivantes : 
 \begin{itemize}
  \item{Récupération des informations en base de données}
  \item{Traitement des données et construction du modèle}
  \item{Traitement du modèle et construction de la vue}
  \item{Affichage de la vue}
 \end{itemize}
 Donc pour la récupération des données en base, trois fonctions sont utilisées à savoir :
 \begin{description}
  \item{\fonction{run\_query\_(day ou week)\_event\_list}} : Cette fonction permet de récupérer les données propres aux évenements(description, titre... mais aussi les dates) ayant lieu le jour ou la semaine passé en paramètre et concernant les utilisateurs passés en paramètre.
  \item{\fonction{run\_query\_get\_user\_name}} : Cette fonction récupére en base de données les noms des utilisateurs dont les id sont passé en paramètre.
  \item{\fonction{run\_query\_userobm}} : Cette fonction récupére l'ensemble des utilisateurs d'\obm(utilisé pour la constitution de la planning bar).
 \end{description}
 Une fois les données récupérées, elles sont donc traités afin de constituer le modèle.
 En premier lieu les informations sur les utilisateurs récupérés par la fonction \fonction{run\_query\_get\_user\_name} sont stockées dans un tableau,\variable{calendar\_user}, ou chaque utilisateur est associé à une couleur et a une classe \css et une à une image, et ce dans la fonction \fonction{store\_users}.
 Ensuite est constitué le modèle. Celui-ci est construit dans la fonction \fonction{store\_events}. Cette fonction renvoit deux tableaux, le premier,\variable{event\_data}, indexé sur les id des evenements, stocke l'ensemble des données relative a un evenement ainsi que le nombre total de ces occurences sur le jour ou la semaine. Le second,\variable{current\_events}, est un tableau indéxé sur le temps, contient pour chaque unité de temps(l'unité de temps est definit dans le fichier \fichier{global.inc}) la ou les id des evenements ayant lieu à ce moment là.
 \\\textbf{Exemple:}\\
 Prenons la vue quotidienne pour les utilisateurs U1 et U2.
 Voici la liste des évenements de ces deux utilisateur pour le jour J1 :\\
 \begin{tabular}{|c|c|c|c|}
  \hline
   \textbf{Evenements} & \textbf{Heures} & \textbf{U1} & \textbf{U2} \\
  \hline
  \hline
   E1 & H1->H3 & X & \\
   E2 & H2->H4 & & X \\
   E3 & H6->H7 & X & X \\
   E4 & H3->H4 & X &  \\
  \hline
 \end{tabular}  
\\Donc le tableau de données sera de la forme :\\
 \begin{tabular}{|c|c|c|}
  \hline
   \textbf{Id} & \textbf{Information} & \textbf{Occurence} \\
  \hline
  \hline
   E1 & I1 & 1 \\
  \hline
   E2 & I2 & 1 \\
  \hline
   E3 & I3 & 2 \\
  \hline
   E4 & I4 & 1 \\
  \hline
 \end{tabular} 
\\L'évenement E3 à 2 occurences, car il y en a une pour l'utilisateur U1 et une pour l'utilisateur U2.
Le tableau contenant le modèle proprement dit sera de la forme suivante :\\
 \begin{tabular}{|c|c|c|}
  \hline
   \textbf{Heures} & \textbf{U1} & \textbf{U2} \\
  \hline
  \hline
   H1 & E1 & \\
  \hline
   H2 & E1 & E2 \\
  \hline
   H3 & E1,E4 & E2 \\
  \hline
   H4 & E4 & E2 \\
  \hline
   H6 & E3 & E3 \\
  \hline
   H7 & E3 & E3 \\
  \hline
 \end{tabular} 
 \\\textbf{Fin exemple}\\
 Une fois le modèle constitué il est traité dans la fonction \fonction{dis\_planning\_(day ou week)}.
 Pour ce faire, on entrera dans une structure de controle qui bouclera sur les unité de temps. A chaque itération on vérifie pour 
 chaque utilisateur si il y a un évemenement à l'unité de temps en cours dans le tableau \variable{current\_events}.
 Si oui alors :
 \begin{itemize}
  \item{On test si les informations de cet évenement on déjà était affiché pour cet utilisateur. Si oui on continue l'iteration sur les unités de temps}
  \itemize{Si non, on insère dans la vue les informations propre à l'evenement détécté et dans \variable{event\_data} on diminue le nombre d'occurence de l'evenement de 1.}
  \item{On determine la taille de la case contenant les informations en comptant le nombre de boucle qui reponde à la condition : intersection des évenement à l'heure T et des évenements a l'heure T+1 n'est pas nulle. Cette condition permet en fait de determiné la plage horraire sur laquelle se deroule l'evenement et eventuellement les évenements qui sont en conflits avec celui ci.}
  \item{On reprend l'iteration sur les unités de temps}
 \end{itemize}
Enfin on affiche la vue.
 \\\textbf{Exemple:}\\
Reprenons l'exemple ci-dessus :
On boucle donc sur les unités de temps :


H1 : Un évenement pour l'utilisateur U1 dans le tableau.\\
Dans \variable{event\_data} le nombre d'occurence de E1 > 0.\\
On insère donc dans la vue les information I1 et on decrement le nombre d'occurence de E1.\\
On boucle sur la \variable{current\_events}:\\
\begin{itemize}
 \item{H2 : Dans \variable{event\_data} le nombre d'occurence de E1 = 0.Intersection de \variable{current\_events[H1][U1]} et \variable{current\_events[H2][U1]} = E1. On continue donc a boucler.}
 \item{H3 : Dans \variable{event\_data} le nombre d'occurence de E1=0 et E4 > 0.On insère donc dans la vue les information I4 et on decrement le nombre d'occurence de E4. Intersection de \variable{current\_events[H3][U1]} et \variable{current\_events[H4][U1]} = E4. On continue donc a boucler.}
 \item{H4 : Dans \variable{event\_data} le nombre d'occurence de E4=0.Intersection de \variable{current\_events[H4][U1]} et \variable{current\_events[H5][U1]} = NULL. On arrete donc de boucler. La taille de la case sera donc de 4.}
On reprend l'iteration sur les heures :\\
\end{itemize}
H2: Un évenement pour l'utilisateur U1 et U2 dans le tableau.\\
Dans \variable{event\_data} le nombre d'occurence de E1 = 0, donc on ne s'en occupe pas, par contre pour E2 il est supérieur à 0.\\
On insère donc dans la vue les information I2 et on decrement le nombre d'occurence de E2.\\
On boucle sur la \variable{current\_events}:\\
\begin{itemize}
 \item{H3 : Dans \variable{event\_data} le nombre d'occurence de E2 = 0.Intersection de \variable{current\_events[H3][U2]} et \variable{current\_events[H4][U2]} = E2. On continue donc a boucler.}
 \item{H4 : Dans \variable{event\_data} le nombre d'occurence de E2 = 0.Intersection de \variable{current\_events[H4][U2]} et \variable{current\_events[H5][U2]} = E2. On arrete donc de boucler. La taille de la case sera donc de 3.}
\end{itemize} 
H3 : Deux évenements pour l'utilisateur U1 et un pour l'utilisateur U2 dans le tableau.\\
Dans \variable{event\_data} le nombre d'occurence de E1, E4 et E2 sont égaux à 0, donc on ne s'en occupe pas.\\
H4 : Un évenement pour l'utilisateur U1 et U2 dans le tableau.\\
Dans \variable{event\_data} le nombre d'occurence de E4 et E2 sont égaux à 0, donc on ne s'en occupe pas.\\
H5 : Pas d'évenements.
H6 : Un évenement pour l'utilisateur U1 et U2 dans le tableau.\\
Dans \variable{event\_data} le nombre d'occurence de E3 > 0, on insère donc dans la vue les information I3 pour l'utilisateur U1 et on decrement le nombre d'occurence de E3. Le nombre d'occurence de E3 > 0 On insère donc dans la vue les information I3 pour l'utilisateur U2 et on decrement le nombre d'occurence de E3.\\
On boucle sur la \variable{current\_events}:\\
\begin{itemize}
 \item{H7 : Dans \variable{event\_data} le nombre d'occurence de E3 = 0.Intersection de \variable{current\_events[H6][U2]} et \variable{current\_events[H7][U2]} = E2. On continue donc a boucler.}
 \item{On arrive à la fin du tableau \variable{current\_events} on arrete donc la boucle.La taille de la case sera donc de 2}
\end{itemize} 
On à terminé la boucle sur les unités de temps. On affiche donc la vue qui ressemblera a cela :\\
\begin{center}
 \begin{tabular}{|c|c|c|}
  \hline
   \textbf{Heure} & \textbf{U1} & \textbf{U2} \\
  \hline
  \hline
  H1 & I1 & \\
  \cline{1-1}
  \cline{3-3}
  H2 & I4 & I2 \\
  \cline{1-1} 
  H3 &  &  \\
  \cline{1-1} 
  H4 &  &  \\
  \hline 
  H5 &  &  \\
  \hline
  H6 & I3 & I3 \\
  \cline{1-1} 
  H7 & I3 & I3 \\
  \hline
 \end{tabular}  
\end{center}

\textbf{Fin exemple}\\
En ce qui concerne les vues annuelles et mensuelles, la difference se situe au niveau de la constitution du tableau \variable{current\_events}. Ce tableau est indexé sur les jours et non sur les unités de temps ( la fonction utilisé pour ce faire est la fonction \fonction{store\_daily\_events}). Ceci est du au fait que la vue pour ces affichages là est faites par jour et non par unité de temps. A part cela le fonctionnement est strictement le même.

\subsubsection{Insertion}

