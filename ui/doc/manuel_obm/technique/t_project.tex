\section{Calendar}

Le module \project \obm  est un agenda partagé permettant d'inserer, modifier, consulter ou supprimer des évenements pour un ou plusieurs utilisateurs simultané.

\clearpage

\subsection{Organisation de la base de données}

Le \calendar utilise trois tables :
\begin{itemize}
 \item Deal (aussi utilisé par le module \deal)
 \item ProjectTask
 \item ProjectUser
 \item ProjectStat
\end{itemize}

\subsubsection{Deal}
Cette table utilisée pour stocker les informations relatives aux affaires.
Elle sert aussi à stocker certaines infos relatives spécifiquement aux projets.
Nous ne détaillerons que les informations utilisées par le module \project.
\begin{description}
 \item[deal\_id] int(8) : C'est la clé primaire de la table.
 \item[deal\_timeupdate] timestamp(14) : Donne au format Unix la date de dernière mise à jour du tuple.
 \item[deal\_timecreate] timestamp(14) : Donne au format Unix la date de création du tuple.
 \item[deal\_userupdate] int(8) : Id de l'utilisateur qui à opéré la dernière mise à jour.
 \item[deal\_usercreate] int(8) : Id de l'utilisateur qui à créé le tuple.
 \item[deal\_label] varchar(128) : label du projet.
 \item[deal\_company\_id] int(8) : Clé étrangère pointant vers Company indiquant la société puor laquelle le projet est réalisée (sauf pour le projets internes).
 \item[deal\_tasktype\_id] int(8) : Clé étrangère pointant vers TaskType indiquant le type de tâche concerné par ce projet.
 \item[deal\_soldtime] int(8) : Durée en jours de travail vendue à la société pour laquelle ce projet est réalisé.
 \item[deal\_project\_status] int(1) : Indique si le projet est est encore au stade d'affaire, s'il est en cours ou si il s'agit d'un projet interne (pas de partie affaire).
 \item[deal\_archive] int(2) : Indique si le projet (et l'affaire qui lui est associée) est archivé.
\end{description}

\subsubsection{ProjectTask}
Cette table stocke les informations relatives au découpage d'un projet en tâches.
\begin{description}
 \item[projecttask\_id] int(8) : C'est la clé primaire de la table.
 \item[projecttask\_timeupdate] timestamp(14) : Donne au format Unix la date de dernière mise à jour du tuple.
 \item[projecttask\_timecreate] timestamp(14) : Donne au format Unix la date de création du tuple.
 \item[projecttask\_userupdate] int(8) : Id de l'utilisateur qui à opéré la dernière mise à jour.
 \item[projecttask\_usercreate] int(8) : Id de l'utilisateur qui à créé le tuple.
 \item[projecttask\_label] varchar(255) : Label de la tâche.
 \item[projecttask\_deal\_id] int(8) : Clé étrangère pointant vers Deal indiquant le projet auquel est rataché cette tâche.
 \item[projecttask\_parenttask\_id] int(8)  : Clé étrangère pointant vers ProjectTask indiquant s'il s'agit d'une sous-tâche ratachée à une autre tâche du projet
 \item[projecttask\_rank] int(8) : Valeur qui permet de gérer l'ordre d'affichage des tâches.
\end{description}

\subsubsection{ProjectUser}
Cette table stocke les informations relatives à l'affectation d'utilisateurs à des projets.
Ils sont en réalité ratachés à une tâche du projet.
\begin{description}
 \item[projectuser\_id] int(8) : C'est la clé primaire de la table.
 \item[projectuser\_user\_id] int(8) : Clé étrangère pointant vers UserObm indiquant l'utilisateur concerné.
 \item[projectuser\_deal\_id] varchar(12) :Clé étrangère pointant vers Deal indiquant le projet auquel est rataché l'utilisateur. Cette information peut sembler redondante mais est nécessaire pour pouvoir affecter un utilisateur à un projet avant que les tâches du projet ne soient définies.
 \item[projectuser\_projecttask\_id] varchar(12) :Clé étrangère pointant vers ProjectTask indiquant la tâche à laquelle est affecté cet utilisateur.
 \item[projectuser\_timeupdate] timestamp(14) : Donne au format Unix la date de dernière mise à jour du tuple.
 \item[projectuser\_timecreate] timestamp(14) : Donne au format Unix la date de création du tuple.
 \item[projectuser\_userupdate] int(8) : Id de l'utilisateur qui à opéré la dernière mise à jour.
 \item[projectuser\_usercreate] int(8) : Id de l'utilisateur qui à créé le tuple.
 \item[projectuser\_projectedtime] varchar(5) : .
 \item[projectuser\_missingtime] varchar(5) : .
 \item[projectuser\_validity] char(1) : Date de la dernière modification de l'avancement. Permet de vérifier la crédibilité des informations disponibles sur l'avancement du projet (non implémenté pour l'instant).
 \item[projectuser\_soldprice] char(1) : Tarif horaire de cet utilisateur. Permet une analyse des coûts plus détaillée pour le projet (non implémenté pour l'instant).
 \item[projectuser\_manager] char(1) : Indique si la personne est chef de projet. Influe sur les droits de modification.
\end{description} 

\subsubsection{ProjectStat}
Cette table stocke les informations relatives à l'avancement du projet à chaque fois que celles-ci sont modifiées.

\begin{description}
 \item[projectstat\_deal\_id] int(8) : C'est la clé primaire de la table. Indique le projet concerné.
 \item[projectstat\_date] timestamp(14) : C'est la clé primaire de la table. Donne au format Unix à laquelle a été effectué le log.
 \item[projectstat\_timecreate] timestamp(14) : Donne au format Unix la date de création du tuple.
 \item[projectstat\_usercreate] int(8) : Id de l'utilisateur qui à créé le tuple.
 \item[projectstat\_useddays] int(8) : Nombre de jours de travail passés sur le projet au moment du log.
 \item[projectstat\_remainingdays] int(8) : Nombre de jours de travail estimé restant pour terminer le projet au moment du log.
\end{description} 

\clearpage


\subsection{Actions, droits, et fonctions}
Dans cette section seront listées et décrites les actions du module, ainsi que les droits qui leurs sont appliqués et l'intitulé des fonctions executées. 

\subsubsection{Actions}

Voici la liste des action du module \project, ainsi qu'une description sommaire de chacune d'entre elles.\\
\begin{tabular}{|c|p{9cm}|}
 \hline
 \textbf{Intitulé} & \textbf{Description} \\
 \hline
 \hline
  <index> & Action par défaut, elle affiche le formulaire de recherche de projets. \\ 
 \hline
  <search> & Affiche le formulaire de recherche de projets et le résultat de la recherche. \\
 \hline
  <new> & Affiche le formulaire permettant de créer interne. \\
 \hline
  <init> & Affiche le formulaire permettant de créer un projet à partir d'une affaire. \\
 \hline
  <task\_fill> & Affiche le formulaire permettant l'ajout de tâches au projet et la liste des tâches déjà existantes. \\
 \hline
  <member\_fill> & Affiche la liste des participants au projet et leurs statuts respectifs. \\
 \hline
  <membertime\_fill> & Affiche le formulaire permettant l'affectation des participants aux différentes tâches. \\
 \hline
  <vaildate> & Valide les modifications faites à l'écran de modification des affectations et affiche l'écran de consultation. \\
 \hline
  <detailconsult> & Affiche l'écran de consultation. \\
 \hline
  <detailupdate> & Affiche le formulaire permettant de modifier les informations relatives au projet. \\
 \hline
  <d\_update> & Valide les modifications faites à l'écran de modification du projet et affiche l'écran de consultation. \\
 \hline
  <advanceupdate> & Affiche le formulaire permettant de modifier les informations relatives au projet. \\
 \hline
  <a\_update> & Valide les modifications faites à l'écran de modification de l'avancement et affiche l'écran de consultation. \\
 \hline
  <ext\_get\_ids> & affiche une fenêtre permettant d'ajouter des participants au projet (géré par le module \user). \\
 \hline
  <task\_add> & Ajoute une tâche et affiche le formulaire permettant l'ajout de tâches au projet et la liste des tâches déjà existantes. \\
 \hline
  <task\_del> & Supprime une tâche et affiche le formulaire permettant l'ajout de tâches au projet et la liste des tâches déjà existantes. \\
 \hline
  <member\_add> & Ajoute un participant et affiche la liste des participants au projet et leurs statuts respectifs. \\
 \hline
  <member\_del> & Enlève in participant et affiche la liste des participants au projet et leurs statuts respectifs. \\
 \hline
  <member\_change> & Change le statut (chef de projet/simple participant) et affiche la liste des participants au projet et leurs statuts respectifs. \\
 \hline
  <display\_pref> & Affiche l'écran de modification des préférences d'affichage. \\
 \hline
  <dispref\_display> & Modifie l'affichage d'un élément et affiche l'écran de modification des préférences d'affichage. \\
 \hline
  <dispref\_level> & Modifie l'ordre d'affichage et affiche l'écran de modification des préférences d'affichage. \\
 \hline
\end{tabular}

\clearpage

\subsubsection{Droits}

Ci-dessous le tableau présentant les droits necessaires à l'execution de chaque action ainsi que l'intitulé de ce droit. \\
\begin{tabular}{|c|c|l|}
 \hline
 \textbf{Action} & \textbf{Code du droit} & \textbf{Intitulé du droit}\\
 \hline
 \hline
  <index> & project\_read & Droits d'Utilisateur en lecture. \\ 
 \hline
  <search> & project\_read & Droits d'Utilisateur en ecriture. \\ 
 \hline
  <new> & project\_write & Droits d'Utilisateur en lecture. \\ 
 \hline
  <init> & project\_write & Droits d'Utilisateur en lecture. \\
 \hline
  <task\_fill> & project\_write & Droits d'Utilisateur en lecture. \\
 \hline
  <member\_fill> & project\_write & Droits d'Utilisateur en ecriture. \\
 \hline
  <membertime\_fill> & project\_write & Droits d'Utilisateur en ecriture. \\ 
 \hline
  <validate> & project\_write & Droits d'Utilisateur en ecriture. \\ 
 \hline
  <detailconsult> & project\_read & Droits d'Utilisateur en lecture. \\ 
 \hline
  <detailupdate> & project\_write & Droits d'Utilisateur en lecture. \\
 \hline
  <d\_update> & project\_write & Droits d'Administrateur en ecriture. \\
 \hline
  <advanceupdate> & project\_write & Droits d'Administrateur en ecriture. \\
 \hline
  <a\_update> &  project\_write & Droits d'Utilisateur en ecriture. \\
 \hline
  <ext\_get\_ids> &  user\_write & Droits d'Utilisateur en ecriture. \\
 \hline
  <task_add> & project\_write & Droits d'Utilisateur en ecriture. \\
 \hline
  <task_del> & project\_write & Droits d'Utilisateur en ecriture. \\
 \hline
  <member_add> & project\_write & Droits d'Utilisateur en ecriture. \\
 \hline
  <member_del> & project\_write & Droits d'Utilisateur en ecriture. \\
 \hline
  <member_change> & project\_write & Droits d'Utilisateur en ecriture. \\
 \hline
  <display> & project\_read & Droits d'Utilisateur en ecriture. \\
 \hline
  <dispref_display> & project\_read & Droits d'Utilisateur en ecriture. \\
 \hline
  <dispref_level> & project\_read & Droits d'Utilisateur en ecriture. \\
 \hline
\end{tabular}
Les 

\subsubsection{Fonctions}
 Ci-dessous le tableau présentant la ou les fonctions appelées pour chacune des actions. \\
\begin{tabular}{|c|c|}
 \hline
 \textbf{Action} & \textbf{Fonction(s)}\\
 \hline
 \hline
  <index> & dis\_project\_search\_form() \\
 \hline
  <search> & dis\_project\_search\_form() \\
           & dis\_project\_search\_list() \\
 \hline
  <new> & run\_query\_projecttype() \\ 
        & html\_project\_form() \\
 \hline
  <init> & run\_query\_detail() \\ 
         & html\_project\_init\_form() \\
 \hline
  <task\_fill> & run\_query\_projectname() \\
 	       & run\_query\_tasks() \\
	       & html\_project\_taskadd\_form() \\
	       & html\_project\_tasklist() \\
 \hline
  <member\_fill> & run\_query\_projectname() \\
 	         & run\_query\_tasks() \\
	         & run\_query\_members() \\
	         & html\_project\_member\_form() \\
 \hline
  <membertime\_fill> & run\_query\_projectname() \\
 	             & run\_query\_tasks() \\
	             & run\_query\_members() \\
	             & run\_query\_membertime() \\
                     & html\_project\_membertime\_form() \\
 \hline
  <validate> & run\_query\_projectupdate() \\
             & run\_query\_detail() \\ 
 	     & run\_query\_tasks() \\
	     & run\_query\_members() \\
	     & run\_query\_membertime() \\
             & html\_project\_consult() \\
 \hline
 \end{tabular}

\begin{tabular}{|c|c|p{3cm}|}
 \hline
 \textbf{Action} & \textbf{Fonction(s)} \\
 \hline
 \hline
  <detailconsult> & run\_query\_create() \\
                  & run\_query\_detail() \\ 
                  & html\_project\_consult() \\
                  & ou \\
                  & run\_query\_insert() \\
                  & run\_query\_detail() \\ 
                  & html\_project\_consult() \\
                  & ou \\
                  & run\_query\_detail() \\ 
 	          & run\_query\_tasks() \\
	          & run\_query\_members() \\
	          & run\_query\_membertime() \\
                  & html\_project\_consult() \\
 \hline
  <detailupdate> & run\_query\_detail() \\ 
                 & html\_project\_init\_form() \\
                 & ou \\
                 & run\_query\_projecttype() \\
                 & html\_project\_form() \\
 \hline
 <d\_update> & run\_query\_update() \\ 
             & run\_query\_detail() \\ 
 	     & run\_query\_tasks() \\
	     & run\_query\_members() \\
	     & run\_query\_membertime() \\
             & html\_project\_consult() \\
 \hline
  <advanceupdate> & run\_query\_projectname() \\
 	          & run\_query\_tasks() \\
	          & run\_query\_members() \\
	          & run\_query\_membertime() \\
                  & html\_project\_advance() \\
 \hline
 <a\_update> & run\_query\_advanceupdate() \\ 
             & run\_query\_statlog() \\ 
             & run\_query\_detail() \\ 
 	     & run\_query\_tasks() \\
	     & run\_query\_members() \\
	     & run\_query\_membertime() \\
             & html\_project\_consult() \\
 \hline
\end{tabular}

\begin{tabular}{|c|c|p{3cm}|}
 \hline
 \textbf{Action} & \textbf{Fonction(s)} \\
 \hline
 \hline
 <task\_add> & run\_query\_tasklist\_insert()\\ 
             & run\_projectname() \\
             & run\_query\_tasks() \\
	     & html\_project\_taskadd\_form() \\
	     & html\_project\_tasklist() \\
 \hline 
 <task\_del> & run\_query\_tasklist\_delete()\\ 
             & run\_projectname() \\
             & run\_query\_tasks() \\
	     & html\_project\_taskadd\_form() \\
	     & html\_project\_tasklist() \\
 \hline
 <member\_add> & run\_query\_projectname() \\
               & run\_query\_memberlist\_insert()\\ 
 	       & run\_query\_tasks() \\
	       & run\_query\_members() \\
	       & html\_project\_member\_form() \\
 \hline 
 <member\_del> & run\_query\_projectname() \\
               & run\_query\_memberlist\_delete()\\ 
 	       & run\_query\_tasks() \\
	       & run\_query\_members() \\
	       & html\_project\_member\_form() \\
 \hline 
 <member\_change> & run\_query\_projectname() \\
                  & run\_query\_memberstatus\_change()\\ 
 	          & run\_query\_tasks() \\
	          & run\_query\_members() \\
	          & html\_project\_member\_form() \\
 \hline
  <display> & run\_query\_display_pref() \\
            & dis\_project\_display_pref() \\
 \hline
  <dispref\_display> & run_query\_display\_pref\_update() \\
                     & run_query\_display\_pref() \\
                     & dis_project\_display\_pref() \\
 \hline
  <dispref\_level> & run\_query\_display\_pref\_level\_update() \\
                   & run\_query\_display\_pref() \\
                   & dis\_project\_display\_pref() \\
 \hline
\end{tabular}

\subsection{Fonctionalité}
 Dans cette partie seront abordées les fonctionnalités du module \project. Ces fonctionnalités seront étudiés d'un point de vue technique et non utilisateur. Il va donc plus etre sujet du fonctionnement que de l'utilité et de l'utilisation du module.

\subsubsection{Affichage}

\subsubsection{Insertion}

